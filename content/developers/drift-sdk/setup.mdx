# Setup

The examples below use placeholders like `<RPC_URL>` and `<KEYPAIR_PATH>`.

### Program addresses

The Drift program id is environment-specific. In most cases youâ€™ll use the default program id baked into the SDK config for `devnet` or `mainnet-beta`.

### Wallet / authentication

To interact with Solana you need a keypair. One common approach for bots is to point `ANCHOR_WALLET` (or your own env var) at a JSON keypair file.

```bash
solana-keygen new --outfile ~/.config/solana/my-keypair.json
export ANCHOR_WALLET=~/.config/solana/my-keypair.json
```

### Install

```bash
npm i @drift-labs/sdk
```

### Numeric types (BN) and precision helpers

The SDK represents most on-chain numbers as integers using BN-style big numbers. Use helper functions + precision constants to convert into human units when needed.

<SDKDoc>
  <TypeScript name="convertToNumber" type="function">
```js
import { BN, PRICE_PRECISION, convertToNumber } from "@drift-labs/sdk";

const raw = new BN(10_500_000); // e.g. 10.5 with 1e6 precision
const human = convertToNumber(raw, PRICE_PRECISION);
console.log(human);
```
  </TypeScript>
  <Python name="driftpy.math.conversion.convert_to_number">
```py
from driftpy.constants.numeric_constants import PRICE_PRECISION
from driftpy.math.conversion import convert_to_number

# TODO: replace with a real DriftPy example
raw = 10_500_000  # e.g. 10.5 with 1e6 precision
human = convert_to_number(raw, PRICE_PRECISION)
print(human)
```
  </Python>
</SDKDoc>

<SDKDoc>
  <TypeScript name="PRICE_PRECISION" type="variable">
```js
import { PRICE_PRECISION } from "@drift-labs/sdk";
```
  </TypeScript>
  <Python name="driftpy.constants.numeric_constants.PRICE_PRECISION">
```py
from driftpy.constants.numeric_constants import PRICE_PRECISION

# TODO: replace with a real DriftPy example
print(PRICE_PRECISION)
```
  </Python>
</SDKDoc>

### Create a Drift client

At a minimum you provide a Solana `connection`, a `wallet`, and the `env`. Then call `subscribe()` to start receiving account updates.

<SDKDoc>
  <TypeScript name="loadKeypair" type="function">
```js
import { loadKeypair } from "@drift-labs/sdk";

const keypair = loadKeypair("<KEYPAIR_PATH>");
```
  </TypeScript>
  <Python name="driftpy.keypair.load_keypair">
```py
from driftpy.keypair import load_keypair

# TODO: replace with a real DriftPy example
keypair = load_keypair("<KEYPAIR_PATH>")
```
  </Python>
</SDKDoc>

<SDKDoc>
  <TypeScript name="Wallet" type="class">
```js
import { Wallet, loadKeypair } from "@drift-labs/sdk";

const wallet = new Wallet(loadKeypair("<KEYPAIR_PATH>"));
```
  </TypeScript>
  <Python name="anchorpy.Wallet">
```py
from anchorpy import Wallet
from driftpy.keypair import load_keypair

# TODO: replace with a real DriftPy example
wallet = Wallet(load_keypair("<KEYPAIR_PATH>"))
```
  </Python>
</SDKDoc>

<SDKDoc>
  <TypeScript name="DriftClient" type="class">
```js
import { Connection } from "@solana/web3.js";
import { DriftClient, Wallet, loadKeypair } from "@drift-labs/sdk";

const connection = new Connection("<RPC_URL>", "confirmed");
const wallet = new Wallet(loadKeypair("<KEYPAIR_PATH>"));

const driftClient = new DriftClient({
  connection,
  wallet,
  env: "mainnet-beta",
});

await driftClient.subscribe();
```
  </TypeScript>
  <Python name="driftpy.drift_client.DriftClient">
```py
from anchorpy import Provider, Wallet
from solana.rpc.async_api import AsyncClient

from driftpy.constants.config import configs
from driftpy.drift_client import DriftClient
from driftpy.keypair import load_keypair

# TODO: replace with a real DriftPy example
config = configs["mainnet"]
connection = AsyncClient(config.default_http)
wallet = Wallet(load_keypair("<KEYPAIR_PATH>"))
provider = Provider(connection, wallet)

drift_client = DriftClient(connection, wallet, env="mainnet")
await drift_client.subscribe()
```
  </Python>
</SDKDoc>

<SDKDoc>
  <TypeScript name="subscribe" type="method" owner="DriftClient">
```js
await driftClient.subscribe();
```
  </TypeScript>
  <Python name="driftpy.drift_client.DriftClient.subscribe">
```py
# TODO: replace with a real DriftPy example
await drift_client.subscribe()
```
  </Python>
</SDKDoc>

<SDKDoc>
  <TypeScript name="fetchAccounts" type="method" owner="DriftClient">
```js
// Force-refresh all tracked accounts from RPC.
await driftClient.fetchAccounts();
```
  </TypeScript>
  <Python name="driftpy.accounts.ws.drift_client.WebsocketDriftClientAccountSubscriber.fetch">
```py
# TODO: replace with a real DriftPy example
await drift_client.account_subscriber.fetch()
```
  </Python>
</SDKDoc>

<SDKDoc>
  <TypeScript name="unsubscribe" type="method" owner="DriftClient">
```js
await driftClient.unsubscribe();
```
  </TypeScript>
  <Python name="driftpy.drift_client.DriftClient.unsubscribe">
```py
# TODO: replace with a real DriftPy example
await drift_client.unsubscribe()
```
  </Python>
</SDKDoc>

### Account subscriptions (websocket vs polling)

For most bots, websocket subscriptions are the easiest way to keep markets and users up to date. For read-only workflows or when you need tighter control over RPC load, you can switch to polling with a `BulkAccountLoader`.

<SDKDoc>
  <TypeScript name="BulkAccountLoader" type="class">
```js
import { BulkAccountLoader } from "@drift-labs/sdk";
```
  </TypeScript>
  <Python name="driftpy.accounts.bulk_account_loader.BulkAccountLoader">
```py
from driftpy.accounts.bulk_account_loader import BulkAccountLoader

# TODO: replace with a real DriftPy example
account_loader = BulkAccountLoader(connection, "confirmed", 0)
```
  </Python>
</SDKDoc>

```js
import { BulkAccountLoader } from "@drift-labs/sdk";

const accountLoader = new BulkAccountLoader(connection, "confirmed", 0);

const driftClient = new DriftClient({
  connection,
  wallet,
  env: "mainnet-beta",
  accountSubscription: {
    type: "polling",
    accountLoader,
  },
  // Optional: explicitly list markets/oracles to load.
  // perpMarketIndexes: [0, 1],
  // spotMarketIndexes: [0],
  // oracleInfos: [{ publicKey: <ORACLE_PUBKEY>, source: <ORACLE_SOURCE> }],
});
```

### Multiple subaccounts

<SDKDoc>
  <TypeScript name="hasUser" type="method" owner="DriftClient">
```js
if (!driftClient.hasUser(1)) {
  await driftClient.addUser(1);
}
```
  </TypeScript>
  <Python name="driftpy.drift_client.DriftClient.get_user">
```py
# TODO: replace with a real DriftPy example
try:
    drift_client.get_user(1)
except KeyError:
    await drift_client.add_user(1)
```
  </Python>
</SDKDoc>

<SDKDoc>
  <TypeScript name="addUser" type="method" owner="DriftClient">
```js
await driftClient.addUser(1);
```
  </TypeScript>
  <Python name="driftpy.drift_client.DriftClient.add_user">
```py
# TODO: replace with a real DriftPy example
await drift_client.add_user(1)
```
  </Python>
</SDKDoc>

### Program accounts (advanced)

<SDKDoc>
  <TypeScript name="DRIFT_PROGRAM_ID" type="variable">
```js
import { DRIFT_PROGRAM_ID } from "@drift-labs/sdk";
```
  </TypeScript>
  <Python name="driftpy.constants.config.DRIFT_PROGRAM_ID">
```py
from driftpy.constants.config import DRIFT_PROGRAM_ID

# TODO: replace with a real DriftPy example
print(DRIFT_PROGRAM_ID)
```
  </Python>
</SDKDoc>

<SDKDoc>
  <TypeScript name="getHighLeverageModeConfigPublicKey" type="function">
```js
import { getHighLeverageModeConfigPublicKey } from "@drift-labs/sdk";

const pda = getHighLeverageModeConfigPublicKey(driftClient.program.programId);
const config = await driftClient.program.account.highLeverageModeConfig.fetch(pda);
```
  </TypeScript>
  <Python name="driftpy.addresses.get_high_leverage_mode_config_public_key">
```py
from driftpy.addresses import get_high_leverage_mode_config_public_key

# TODO: replace with a real DriftPy example
pda = get_high_leverage_mode_config_public_key(drift_client.program_id)
```
  </Python>
</SDKDoc>

<SDKDoc>
  <TypeScript name="initialize" type="function">
```js
import { initialize } from "@drift-labs/sdk";

const sdkConfig = initialize({ env: "mainnet-beta" });
console.log(sdkConfig.DRIFT_PROGRAM_ID);
```
  </TypeScript>
  <Python name="driftpy.constants.config.configs">
```py
from driftpy.constants.config import configs

# TODO: replace with a real DriftPy example
sdk_config = configs["mainnet"]
print(sdk_config.DRIFT_PROGRAM_ID)
```
  </Python>
</SDKDoc>

