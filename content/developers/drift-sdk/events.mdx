# Events

Protocol events are emitted in transaction logs. The SDK provides an `EventSubscriber` that can listen, deserialize, and emit events to your app.

<details>
<summary>View EventSubscriber import</summary>

<SDKDoc>
  <TypeScript name="EventSubscriber" type="class">
```js
import { EventSubscriber } from "@drift-labs/sdk";

const options = {
  // eventTypes: ["DepositRecord", "OrderRecord", ...],
  commitment: "confirmed",
  logProviderConfig: { type: "websocket" },
};

const eventSubscriber = new EventSubscriber(connection, driftClient.program, options);
await eventSubscriber.subscribe();

eventSubscriber.eventEmitter.on("newEvent", (event) => {
  console.log(event);
});
```
  </TypeScript>
</SDKDoc>

</details>

### Filtering events

You can filter events by market index, event type, or action using the `isVariant` helper function. This is useful for focusing on specific markets or event types in your bot.

<SDKDoc>
  <TypeScript name="isVariant" type="function">
```js
import { isVariant } from "@drift-labs/sdk";

// Example: Filter for perp fills on a specific market
const marketIndex = 0;

const isPerpFill = (event) => {
  if (event.eventType !== "OrderActionRecord") return false;
  if (event.marketIndex !== marketIndex) return false;
  if (!isVariant(event.marketType, "perp")) return false;
  if (!isVariant(event.action, "fill")) return false;
  return true;
};

eventSubscriber.eventEmitter.on("newEvent", (event) => {
  if (isPerpFill(event)) console.log("Perp fill on market", marketIndex, event);
});
```
  </TypeScript>
</SDKDoc>

**Common filter patterns for bots:**

```js
// Filter by market index only
eventSubscriber.eventEmitter.on("newEvent", (event) => {
  if (event.marketIndex === 0) {
    console.log("Event on market 0:", event);
  }
});

// Filter by event type
eventSubscriber.eventEmitter.on("newEvent", (event) => {
  if (event.eventType === "DepositRecord") {
    console.log("Deposit event:", event);
  }
});

// Filter for liquidations
eventSubscriber.eventEmitter.on("newEvent", (event) => {
  if (event.eventType === "LiquidationRecord") {
    console.log("Liquidation:", event);
  }
});
```

